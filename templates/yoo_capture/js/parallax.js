/* Copyright (C) YOOtheme GmbH, YOOtheme Proprietary Use License (http://www.yootheme.com/license) */

!function(i){i.fn.parallax=function(t){return t=i.extend({},{ratio:8,maxdiff:!1,start:0,mode:"inview",childanimation:!0,childdir:1,childratio:3,childopacity:!0,sizeratio:.38,mintriggerwidth:!1},t),this.each(function(){var a,n=i(this).css("overflow","hidden"),o=i.extend({},t,n.data()),r=n.children().length?n.children().eq(0):n.children(),d=i(window).width(),e="undefined"!==String(window.orientation);i(window).on("scroll",function(){var t=function(){if(!e){if(o.mintriggerwidth&&d<parseInt(o.mintriggerwidth,10))return n.css("background-position",""),void(o.childanimation&&r.length&&r.css({transform:"",opacity:""}));var t,s=i(window).scrollTop(),c=n.offset().top,f=i(window).height(),h=!1;switch(o.mode){case"dock":h=c<s,t=o.maxdiff&&s-c>o.maxdiff?o.maxdiff:s-c;break;case"inview":default:h=f+s>=c,t=o.maxdiff&&Math.abs(s-c)>o.maxdiff?o.maxdiff:s-c}if(h){var l=t/o.ratio;if(n.css({"background-position":"50% -120px"}),o.childanimation&&r.length)if("dock"==o.mode&&c<s)t=o.maxdiff&&s-c>o.maxdiff?o.maxdiff:s-c,l=t/o.childratio,r.css({transform:"translateY("+Math.abs(l)*o.childdir+"px)",opacity:o.childopacity?1-Math.abs(t/a):1});else if("inview"==o.mode){var m=r.offset().top;f+s>=m&&(t=o.maxdiff&&s-m>o.maxdiff?o.maxdiff:s-m,l=t/o.childratio,r.css({transform:"translateY("+Math.abs(l)*o.childdir+"px)",opacity:o.childopacity?1-Math.abs(t/a):1}))}else r.css({transform:"",opacity:""})}else n.css("background-position","100% "+o.start+"px"),o.childanimation&&r.length&&r.css("transform","").css("opacity","")}};return t(),i(window).on("load",t),t}()).on("resize orientationchange",function(){var t=function(){d=i(window).width(),o.sizeratio&&"false"!==o.sizeratio&&"0"!==o.sizeratio&&(a=n.width()*o.sizeratio,n.css("height",a)),r.length&&(a=n.height(),r=n.children().length?n.children().eq(0):n.children())};return t(),t}())})}}(jQuery);